@(addParticipantForm: Form[(Long, String, String)]
)(implicit messages: Messages)

@import helper._

@import models.gift._

<form class="form-search form-inline add-participant-form">
    @addParticipantForm.globalError.map { error =>
      <div class="alert error">
        <p>@error.message</p>
      </div>
    }
    @addParticipantForm.error("eventid").map { error =>
      <div class="alert error">
        <p>@Messages(error.message)</p>
      </div>
    }
    @addParticipantForm.error("email").map { error =>
      <div class="alert error">
        <p>@Messages(error.message)</p>
      </div>
    }
    <div class="well">
  
      <input type="hidden" name="eventid" value="@addParticipantForm("eventid").value">
      
      @if(addParticipantForm.error("username")) {
        <div class="form-group  has-error" id="username_field">
       	  <input type="text" class="input-medium search-query" name="username" value="@addParticipantForm("username").value" placeholder="@play.i18n.Messages.get("participant.addusername")">
			<span id="username_error_0" class="help-block">@addParticipantForm.error("username").get.message</span>
			<span id="username_info_0" class="help-block"></span>
        </div>
      } else {
      	<input type="text" class="input-medium search-query" name="username" value="@addParticipantForm("username").value" placeholder="@play.i18n.Messages.get("participant.addusername")">
      }
      <select name="role">
        @for(role <- Participant.Role.values) {
            <option
            @if(role == addParticipantForm("role").value) {
              selected
            }
            >@role</option>
        }
      </select>
  
      <button type="button" class="btn btn-primary add-participant-btn">Ajouter</button>
    </div>
</form>
<script type="text/javascript">

$('.add-participant-btn').on('click', function(e) {
  $.ajax({
    url: '/addParticipant',
    type: 'GET',
    contentType: "application/x-www-form-urlencoded",
    data: $('.add-participant-form').serializeArray(),
    success: function( response, textStatus, xhr ) {
      $('#participants-table').html(response)
    },
    error: function(jqXHR, textStatus, errorThrown) {
      if(jqXHR.status == 400) {
        $('.add-participant-form').html(jqXHR.responseText)
      }
    }
  });
})
</script>
