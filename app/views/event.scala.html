@(user: models.user.User,
  event: models.gift.Event
)

@import helper._

@import models.user._
@import models.gift._

@import views.html.participants.participants
@import views.html.gifts.gifts
@import views.html.modal.deleteModal

@userHomeTemplate(title = event.name, user = user) {
  <ul class="nav nav-tabs">
    @if(event.eventtype == Event.Type.Birthday) {
      <li class="active"><a href="#gifts" data-toggle="tab">Gifts</a></li>
    } else { 
      @if(event.eventtype == Event.Type.Christmas) {
        <li class="dropdown">
          <a href="#" id="giftsDropdown" class="dropdown-toggle" data-toggle="dropdown">Gifts <b class="caret"></b></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="giftsDropdown">
            @for(p <- Participant.findByEventId(event.id.get)) {
              <li><a href="#dropdownGifts@p.user.id.get" tabindex="-1" data-toggle="tab">@p.user.name</a></li>
            }
          </ul>
        </li>
      }
    }

    <li><a href="#participants" data-toggle="tab">Participants</a></li>
    
  </ul>
  
  <div class="tab-content">
    @gifts(user, event)
    <div class="tab-pane" id="participants">
      @participants(user, event)
    </div>
  </div>
  
  @deleteModal("Confirm deletion",
    "If you delete this gift, you will make tons of users unhappy. Are you sure you want to do that ?")
}


<script type="text/javascript">
  $('.open-delete-modal').click(function() {
    var giftid = $(this).data('id');
    $(".modal-footer #delete-event-form").attr("action", "/deleteGift/" + giftid);
    $('#delete-modal').modal('show');
  });
  

  $('.open-gift-status-modal').click(function() {
    var giftid = $(this).data('id');
    $("#update-gift-status-" + giftid + "-form").attr("action", "/updateGiftStatus/" + giftid);
    $('#update-gift-status-modal-' + giftid).modal('show');
  });
  
  $('.dropdown-toggle').dropdown()
</script>
