@(user:models.user.User)

@import helper._
@import helper.twitterBootstrap._

@import views.html.modal.deleteModal

@import models.gift._

@userHomeTemplate(user = user) {
  <div class="bs-docs-example">
    <table class="table table-striped table-hover table-bordered">
      <thead>
        <tr>
          <th>Event</th>
          <th>Creator</th>
          <th>Date</th>
          <th>Type</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        @for(event <- Event.findByUser(user)) {
          <tr eventid="@event.id.get">
            <td><a href="@routes.Events.event(event.id.get)">@event.name</a></td>
            <td>@event.creator.name</td>
            <td>@event.date.toDate().format("dd/MM/yyyy")</td>
            <td>@event.eventtype</td>
            <td>
              <div class="btn-toolbar">
                <div class="btn-group">
                  <a class="btn" href="@routes.Events.event(event.id.get)"><i class="icon-eye-open"></i></a>
                  @if(event.creator == user) {
                    <a class="btn open-delete-modal" data-id="@event.id.get"><i class="icon-remove"></i></a>
                  }
                </div>
              </div>
            </td>
          </tr>
        }
      </tbody>
    </table>
  </div>
  
  @deleteModal("Confirm deletion",
    "If you delete this event, you will make tons of users unhappy. Are you sure you want to do that ?")
}


<script type="text/javascript">
  $('.open-delete-modal').click(function() {
    var eventid = $(this).data('id');
    $(".modal-footer #delete-event-form").attr("action", "/deleteEvent/" + eventid);
    $('#delete-modal').modal('show');
  });
  $('.open-gift-status-modal').click(function() {
    var giftid = $(this).data('id');
    $(".modal-footer #update-gift-status-" + giftid + "-form").attr("action", "/slip/" + giftid);
    $('#update-gift-status-modal-' + giftid).modal('show');
  });
</script>

